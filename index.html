<!DOCTYPE html>
<html>
    <body>
        <label>Click to toggle the serial</label>
        <button id='button'onclick="toggleSerial()" style="background-color: red;">Disabled</button>
        <div id="serial_dataPanel">
            <p>Distance from sensor (cm) || <label></label></p>
            <p>Distance from sensor (in) || <label></label></p>
            <p>Acceleration(m/s^2) ||x: <label></label>y: <label></label> z:<label></label></p>
            <p>
            Gyro(rad/s) ||x: <label></label>y: <label></label> z:<label></label>
            </p>
            Temperature ||
            <label></label>
        </div>
    </body>

    <script>
        var toggled = true;
        async function toggleSerial(){
            console.log(toggled);
            if(!toggled){
                document.getElementById('button').style.backgroundColor= 'red';
                document.getElementById('button').innerHTML = 'Disabled';
                toggled = true;
            }
            else{
                document.getElementById('button').style.backgroundColor = 'green';
                document.getElementById('button').innerHTML = 'Enabled';
                toggled = false;
            }
            try {
                const rspd = await fetch('/toggle_serial');
                const respond = await rspd.json();
                console.log('Toggled: ',respond);//respond either on or off
            }catch (e){
                console.error('Action : toggle Serial failed: ',e);
            }
        }
        var cm;
        var inch;
        async function fetchSensorData(){
            try{
                const rspd = await fetch('/serial_data');
                const data = await rspd.json();
                cm = data.cm || 0;
                inch = data.inch || 0;
            }catch (e){
                console.error('Failed to fetch sensor data',e);
            }
            updateData();
        }

        function updateData(){
            try{
                labels = document.querySelectorAll('label');
                labels[1].innerText = cm;
                labels[2].innerText = inch;
                labels[3].innerText = a_x;
                labels[4].innerText = a_y;
                labels[5].innerText = a_z;
                labels[6].innerText = g_x;
                labels[7].innerText = g_y;
                labels[8].innerText = g_z;
                labels[9].innerText = temp;
            }catch (e){
                console.error('Failed to update labels',e);
            }
        }
        //make it such that at each .5 second, it will call fetchSensorData
        setInterval(fetchSensorData,1000);
    </script>
</html>